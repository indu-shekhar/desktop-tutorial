<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Voice Authentication - Login</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='styles/style.css') }}"
    />
    <style>
      /* Enlarge and style the title */
      h1 {
        font-size: 36px;
        color: #333;
        text-align: center;
        margin-bottom: 20px;
      }

      /* Additional styles for the header */
    </style>
  </head>
  <body>
    <header id="header">
      <h1>Voice Authentication - Login</h1>
    </header>
    <div id="content-box">
      <main>
        <section class="instructions">
          <p id="instructions">
            Press 'A' to start/stop voice recording, 'C' to start/capture face
            image, and 'Enter' to submit the form.
          </p>
        </section>
        <section class="voice-command">
          <button id="record-btn">Start Recording</button>
          <button id="stop-btn" disabled>Stop Recording</button>
          <audio id="player" controls></audio>
        </section>
        <section class="face-capture">
          <button id="capture-btn">Start Camera</button>
          <video id="camera" autoplay></video>
          <canvas id="snapshot"></canvas>
          <img id="face-preview" alt="Face Preview" />
        </section>
        <form
          id="upload-form"
          action="/login"
          method="POST"
          enctype="multipart/form-data"
        >
          <input
            type="email"
            id="email"
            name="email"
            placeholder="Enter your email"
            required
          />
          <input
            type="file"
            id="audio-file"
            name="audio-file"
            accept="audio/*"
            hidden
          />
          <input
            type="file"
            id="face-image"
            name="face-image"
            accept="image/*"
            hidden
          />
          <input type="submit" value="Submit" />
        </form>
        <p id="result"></p>
      </main>
      <footer>
        <p>&copy; 2023 Voice Authentication. All rights reserved.</p>
      </footer>
    </div>
    <script src="{{ url_for('static', filename='scripts/app.js') }}"></script>
    <script src="https://cdn.jsdelivr.net/npm/wavefile@12.0.0/dist/wavefile.min.js"></script>
    <script>
      const colors = [
        [62, 35, 255],
        [60, 255, 60],
        [255, 35, 98],
        [45, 175, 230],
        [255, 0, 255],
        [255, 128, 0],
      ];

      let step = 0;
      const gradientSpeed = 0.002;
      const colorIndices = [0, 1, 2, 3];

      function updateGradient() {
        const c0_0 = colors[colorIndices[0]];
        const c0_1 = colors[colorIndices[1]];
        const c1_0 = colors[colorIndices[2]];
        const c1_1 = colors[colorIndices[3]];

        const istep = 1 - step;
        const r1 = Math.round(istep * c0_0[0] + step * c0_1[0]);
        const g1 = Math.round(istep * c0_0[1] + step * c0_1[1]);
        const b1 = Math.round(istep * c0_0[2] + step * c0_1[2]);
        const color1 = `rgb(${r1},${g1},${b1})`;

        const r2 = Math.round(istep * c1_0[0] + step * c1_1[0]);
        const g2 = Math.round(istep * c1_0[1] + step * c1_1[1]);
        const b2 = Math.round(istep * c1_0[2] + step * c1_1[2]);
        const color2 = `rgb(${r2},${g2},${b2})`;

        document.body.style.background = `linear-gradient(to right, ${color1}, ${color2})`;

        step += gradientSpeed;
        if (step >= 1) {
          step %= 1;
          colorIndices[0] = colorIndices[1];
          colorIndices[2] = colorIndices[3];

          colorIndices[1] =
            (colorIndices[1] +
              Math.floor(1 + Math.random() * (colors.length - 1))) %
            colors.length;
          colorIndices[3] =
            (colorIndices[3] +
              Math.floor(1 + Math.random() * (colors.length - 1))) %
            colors.length;
        }
      }

      setInterval(updateGradient, 10);
    </script>
  </body>
</html>
